<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Products | KristianiaShop</title>
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <h1>Products</h1>

    <div>
        <h3>Filter</h3>
        <form>
            <select name="productCategory" id="categories"></select>
            <button>Filter</button>
        </form>
    </div>

    <h3>Products</h3>
    <form method="post" action="/shoppingCart">
        <select name="quantity">
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
            <option>6</option>
            <option>7</option>
            <option>8</option>
            <option>9</option>
        </select>
        <div id="productList"></div>
        <button>Add to shopping cart</button>
    </form>

    <div><a href="/shoppingCart.html">Show shopping cart</a></div>

</body>
<script>
    async function fetchProducts() {
        const productsResponse = await fetch("/products" + window.location.search);
        if (productsResponse.ok) {
            const products = await productsResponse.text();
            document.getElementById("productList").innerHTML = products;
        } else {
            console.error("fetch failed " , productsResponse);
        }
    }

    async function fetchCategories() {
        const categoriesResponse = await fetch("/productCategories" + window.location.search);
        if (categoriesResponse.ok) {
            const categories = await categoriesResponse.text();
            document.getElementById("categories").innerHTML = categories;
        } else {
            console.error("fetch failed " , categoriesResponse);
        }
    }

    fetchCategories();
    fetchProducts();
</script>
</html>